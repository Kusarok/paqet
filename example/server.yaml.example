# paqet Server Configuration Example  
# Role must be explicitly set
role: "server"

# Logging configuration
log:
  level: "info"  # none, debug, info, warn, error, fatal

# Server listen configuration
listen:
  addr: ":9999"  # CHANGE ME: Server listen port (must match network.ipv4.addr port)

# Network interface settings
network:
  interface: "eth0"                          # CHANGE ME: Network interface (eth0, ens3, en0, etc.)
  # guid: "\Device\NPF_{...}"                # Windows only (Npcap).
  obfuscation_key: "your-obfuscation-key"    # CHANGE ME: Key for dynamic packet obfuscation (must match client)
  
  # IPv4 configuration
  ipv4:
    addr: "10.0.0.100:9999"                  # CHANGE ME: Server IPv4 and port (port must match listen.addr)
    router_mac: "aa:bb:cc:dd:ee:ff"          # CHANGE ME: Gateway/router MAC address
  
  # IPv6 configuration (optional)
  ipv6:
    addr: "[::1]:9999"                       # CHANGE ME: Server IPv6 and port (or remove if not using IPv6)
    router_mac: "aa:bb:cc:dd:ee:ff"          # CHANGE ME: Gateway/router MAC address
  
  # TCP flags for packet crafting (optional - will use defaults)
  tcp:
    local_flag: ["PA"]                       # Local TCP flags (Push+Ack default)
  
  # PCAP settings (optional - will use optimized defaults)
  pcap:
    sockbuf: 16777216                        # 16MB buffer (optimized default for server, was 2MB)

# Transport protocol configuration
transport:
  protocol: "kcp"  # Transport protocol (currently only "kcp" supported)
  conn: 1          # Number of connections (1-256, increase for higher throughput)
  
  # KCP protocol settings
  kcp:
    mode: "fast3"          # KCP mode: normal, fast, fast2, fast3 (fast3 = lowest latency)
    mtu: 1350              # Maximum transmission unit (50-1500)
    rcvwnd: 2048           # Receive window size (optimized default: 2048, was 1024)
    sndwnd: 2048           # Send window size (optimized default: 2048, was 1024)
    
    # Encryption settings  
    block: "aes"                    # Encryption: aes, aes-128, aes-128-gcm, aes-192, salsa20, blowfish, twofish, cast5, 3des, tea, xtea, xor, sm4, none.
    key: "your-secret-key-here"     # CHANGE ME: Secret key (must match client)
    
    # Buffer settings (optional - optimized defaults applied)
    smuxbuf: 4194304       # 4MB SMUX buffer
    streambuf: 2097152     # 2MB stream buffer
    sockbuf_rcv: 8388608   # 8MB socket receive buffer (optimized default)
    sockbuf_snd: 8388608   # 8MB socket send buffer (optimized default)

# Optional Forward Error Correction (FEC) - currently disabled
# Use these only if you need FEC for very lossy networks:
#   dshard: 10    # Data shards for FEC  
#   pshard: 3     # Parity shards for FEC

# Important: Server Firewall Configuration Required!
# 
# Since paqet uses pcap to bypass standard firewalls, you MUST configure
# iptables on the server to prevent kernel interference:
#
# sudo iptables -t raw -A PREROUTING -p tcp --dport 9999 -j NOTRACK
# sudo iptables -t raw -A OUTPUT -p tcp --sport 9999 -j NOTRACK  
# sudo iptables -t mangle -A OUTPUT -p tcp --sport 9999 --tcp-flags RST RST -j DROP
#
# Replace 9999 with your actual listen port.